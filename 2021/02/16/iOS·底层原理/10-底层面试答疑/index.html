<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>10-åº•å±‚é¢è¯•ç­”ç–‘ - IMO&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="IMO&#039;s Blog"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/speam/blogImgs@main/avatar4.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="IMO&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description=""><meta property="og:type" content="blog"><meta property="og:title" content="10-åº•å±‚é¢è¯•ç­”ç–‘"><meta property="og:url" content="http://evilimo.com/2021/02/16/iOS%C2%B7%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/10-%E5%BA%95%E5%B1%82%E9%9D%A2%E8%AF%95%E7%AD%94%E7%96%91/"><meta property="og:site_name" content="IMO&#039;s Blog"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://evilimo.com/img/og_image.png"><meta property="article:published_time" content="2021-02-16T09:13:47.536Z"><meta property="article:modified_time" content="2021-02-18T08:25:31.097Z"><meta property="article:author" content="IMO"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://evilimo.com/2021/02/16/iOS%C2%B7%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/10-%E5%BA%95%E5%B1%82%E9%9D%A2%E8%AF%95%E7%AD%94%E7%96%91/"},"headline":"IMO's Blog","image":["http://evilimo.com/img/og_image.png"],"datePublished":"2021-02-16T09:13:47.536Z","dateModified":"2021-02-18T08:25:31.097Z","author":{"@type":"Person","name":"IMO"},"description":""}</script><link rel="canonical" href="http://evilimo.com/2021/02/16/iOS%C2%B7%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/10-%E5%BA%95%E5%B1%82%E9%9D%A2%E8%AF%95%E7%AD%94%E7%96%91/"><link rel="icon" href="https://cdn.jsdelivr.net/gh/speam/blogImgs@main/avatar4.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.4.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><meta name="generator" content="Hexo 5.2.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://cdn.jsdelivr.net/gh/speam/blogImgs@main/imglogo.png" alt="IMO&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">é¦–é¡µ</a><a class="navbar-item" href="/archives">å½’æ¡£</a><a class="navbar-item" href="/categories">åˆ†ç±»</a><a class="navbar-item" href="/about">å…³äº</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="ç›®å½•" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-02-16T09:13:47.536Z" title="2021-02-16T09:13:47.536Z">2021-02-16</time>å‘è¡¨</span><span class="level-item"><time dateTime="2021-02-18T08:25:31.097Z" title="2021-02-18T08:25:31.097Z">2021-02-18</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/iOS%C2%B7%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/">iOSÂ·åº•å±‚åŸç†</a></span></div></div><h1 class="title is-3 is-size-4-mobile">10-åº•å±‚é¢è¯•ç­”ç–‘</h1><div class="content"><hr>
<a id="more"></a>

<h1 id="ä¸€ã€ä»€ä¹ˆæ˜¯-Runtime"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯-Runtime" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯ Runtime"></a>ä¸€ã€ä»€ä¹ˆæ˜¯ Runtime</h1><p>ç­”ï¼šç”¨ Cã€C++ã€æ±‡ç¼–å®ç°çš„ä¸€å¥— APIï¼Œä¸º OC è¯­è¨€åŠ å…¥äº†é¢å‘å¯¹è±¡å’Œè¿è¡Œæ—¶çš„åŠŸèƒ½ã€‚</p>
<p><strong>åº”ç”¨ä¸¾ä¾‹ï¼š</strong></p>
<p>ç±»çš„ ro å’Œ rw å±æ€§ï¼Œro(read-only)åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šå¥½äº†ï¼Œè€Œ rw(read-write)æ˜¯åœ¨è¿è¡Œæ—¶æ‰å®Œå…¨èµ‹å€¼ã€‚</p>
<h1 id="äºŒã€æ–¹æ³•çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ"><a href="#äºŒã€æ–¹æ³•çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ" class="headerlink" title="äºŒã€æ–¹æ³•çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ"></a>äºŒã€æ–¹æ³•çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ</h1><p>ç­”ï¼šæ–¹æ³•çš„æœ¬è´¨å°±æ˜¯æ¶ˆæ¯çš„å‘é€ï¼Œå°±æ˜¯åœ¨åº•å±‚è°ƒç”¨<code>_objc_msgSennd</code>æ–¹æ³•å¯»æ‰¾æ–¹æ³•<code>IMP</code>çš„è¿‡ç¨‹ï¼Œä¸»è¦ç»å†äº†ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li><p>å¿«é€ŸæŸ¥æ‰¾æµç¨‹ï¼šé€šè¿‡æ±‡ç¼–ï¼ˆ<code>objc_msgSend</code>ï¼‰æŸ¥æ‰¾<code>cache_t</code>ä¸­ç¼“å­˜çš„æ¶ˆæ¯ï¼Œæ‰¾åˆ°å°±è¿”å›<code>imp</code>ï¼Œæ‰¾ä¸åˆ°å°±è¿›è¡Œæ…¢é€ŸæŸ¥æ‰¾ã€‚</p>
</li>
<li><p>æ…¢é€ŸæŸ¥æ‰¾æµç¨‹ï¼šé€šè¿‡å‡½æ•°<code>lookUpImpOrForward</code>é€’å½’æŸ¥æ‰¾å½“å‰ç±»å’Œçˆ¶ç±»çš„ç¼“å­˜å’Œæ–¹æ³•åˆ—è¡¨ï¼Œå¦‚æœæ‰¾åˆ°äº†å°±ä¼šç¼“å­˜æ–¹æ³•æ–¹ä¾¿å¿«é€ŸæŸ¥æ‰¾ï¼Œæ‰¾ä¸åˆ°å°±ä¼šè¿›è¡ŒåŠ¨æ€æ–¹æ³•è§£æ</p>
</li>
<li><p>åŠ¨æ€æ–¹æ³•è§£æï¼šæ­¤æ—¶<code>OC</code>ä¼šç»™æˆ‘ä»¬ä¸€æ¬¡å¯¹<code>sel</code>çš„å¤„ç†æœºä¼šï¼Œä½ å¯ä»¥åœ¨<code>resolveInstanceMethod:</code>ï¼ˆç±»æ–¹æ³•å¯¹åº”<code>resolveClassMethod:</code>ï¼‰ä¸­æ·»åŠ ä¸€ä¸ª<code>IMP</code></p>
</li>
<li><p>å¦‚æœä½ æ²¡æŠŠæ¡ä½è¿™æ¬¡æœºä¼šï¼Œä¹Ÿå°±æ˜¯è§£æå¤±è´¥æ—¶ï¼Œä¼šæ¥åˆ°<strong>æ¶ˆæ¯è½¬å‘é˜¶æ®µ</strong>ï¼Œè¿™ä¸ªé˜¶æ®µæœ‰ä¸¤ä¸ªæœºä¼šå»å¤„ç†<code>sel</code>ï¼Œåˆ†åˆ«æ˜¯å¿«é€Ÿè½¬å‘çš„<code>forwardingTargetForSelector:</code>ï¼Œä»¥åŠæ…¢é€Ÿè½¬å‘çš„<code>methodSignatureForSelector:</code>ã€‚</p>
<ol>
<li>æ¶ˆæ¯å¿«é€Ÿè½¬å‘ï¼š<code>forwardingTargedForSelector</code>ï¼Œå¦‚æœæœ‰å¤„ç†ï¼Œå°±äº¤ç»™å¤„ç†çš„å¯¹è±¡æ¥å®ç°ï¼Œæ²¡æœ‰å°±äº¤ç»™å…¶ä»–å¯¹è±¡å¤„ç†ï¼Œè¿›å…¥æ…¢é€Ÿè½¬å‘é˜¶æ®µã€‚</li>
<li>æ¶ˆæ¯æ…¢é€Ÿè½¬å‘ï¼š<code>methodSignatureForSelector</code>ï¼Œè¿›è¡Œæ–¹æ³•ç­¾åï¼ŒæŠŠæ–¹æ³•ä¸¢å‡ºå»ï¼Œ<code>forwardInvocation</code>æ¥å¯¹æ¶ˆæ¯å¤„ç†ã€‚</li>
</ol>
</li>
<li><p>æœªæ‰¾åˆ°æ¶ˆæ¯ï¼šæ— æ³•æ‰¾åˆ°<code>IMP</code>ï¼Œå°±è¿›å…¥åˆ°äº†<code>doesNotRecognizeSelector</code>æŠ¥é”™ï¼Œæ‰“å°log</p>
</li>
</ol>
<h1 id="ä¸‰ã€sel-æ˜¯ä»€ä¹ˆï¼ŸIMP-æ˜¯ä»€ä¹ˆï¼Ÿä¸¤è€…ä¹‹é—´çš„å…³ç³»ï¼Ÿ"><a href="#ä¸‰ã€sel-æ˜¯ä»€ä¹ˆï¼ŸIMP-æ˜¯ä»€ä¹ˆï¼Ÿä¸¤è€…ä¹‹é—´çš„å…³ç³»ï¼Ÿ" class="headerlink" title="ä¸‰ã€sel æ˜¯ä»€ä¹ˆï¼ŸIMP æ˜¯ä»€ä¹ˆï¼Ÿä¸¤è€…ä¹‹é—´çš„å…³ç³»ï¼Ÿ"></a>ä¸‰ã€sel æ˜¯ä»€ä¹ˆï¼ŸIMP æ˜¯ä»€ä¹ˆï¼Ÿä¸¤è€…ä¹‹é—´çš„å…³ç³»ï¼Ÿ</h1><p>ç­”ï¼š</p>
<p><code>SEL</code>æ˜¯æ–¹æ³•ç¼–å·ï¼Œä¹Ÿæ˜¯æ–¹æ³•åï¼Œåœ¨dyldåŠ è½½é•œåƒå¸¦å†…å­˜æ—¶ï¼Œé€šè¿‡<code>_read_image</code>æ–¹æ³•åŠ è½½åˆ°å†…å­˜çš„è¡¨ä¸­äº†</p>
<p><code>IMP</code> å°±æ˜¯æˆ‘ä»¬å‡½æ•°å®ç°æŒ‡é’ˆ ï¼Œæ‰¾<code>IMP</code>å°±æ˜¯æ‰¾å‡½æ•°çš„è¿‡ç¨‹</p>
<p><code>å‡½æ•°</code>å°±æ˜¯å¯¹åº”çš„å®ç°å†…å®¹</p>
<h1 id="å››ã€èƒ½å¦å‘è¿â¾æ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ æˆå‘˜å˜é‡ï¼Ÿ"><a href="#å››ã€èƒ½å¦å‘è¿â¾æ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ æˆå‘˜å˜é‡ï¼Ÿ" class="headerlink" title="å››ã€èƒ½å¦å‘è¿â¾æ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ æˆå‘˜å˜é‡ï¼Ÿ"></a>å››ã€èƒ½å¦å‘è¿â¾æ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ æˆå‘˜å˜é‡ï¼Ÿ</h1><p>ç­”ï¼šä¸èƒ½ã€‚</p>
<p>åŸå› ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">class_ro_t</span> &#123;</span></span><br><span class="line">    <span class="keyword">uint32_t</span> flags;</span><br><span class="line">    <span class="keyword">uint32_t</span> instanceStart;</span><br><span class="line">    <span class="keyword">uint32_t</span> instanceSize;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __LP64__</span></span><br><span class="line">    <span class="keyword">uint32_t</span> reserved;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">uint8_t</span> * ivarLayout;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> * name;</span><br><span class="line">    <span class="keyword">method_list_t</span> * baseMethodList;     <span class="comment">// æ–¹æ³•åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">protocol_list_t</span> * baseProtocols;    <span class="comment">// åè®®åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">ivar_list_t</span> * ivars;          <span class="comment">// æˆå‘˜å˜é‡åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">uint8_t</span> * weakIvarLayout;</span><br><span class="line">    <span class="keyword">property_list_t</span> *baseProperties;    <span class="comment">// å±æ€§åˆ—è¡¨</span></span><br><span class="line">  </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">class_rw_t</span> &#123;</span></span><br><span class="line">    <span class="comment">// Be warned that Symbolication knows the layout of this structure.</span></span><br><span class="line">    <span class="keyword">uint32_t</span> flags;</span><br><span class="line">    <span class="keyword">uint32_t</span> version;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">class_ro_t</span> *ro;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">method_array_t</span> methods;        <span class="comment">// æ–¹æ³•åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">property_array_t</span> properties;   <span class="comment">// å±æ€§åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">protocol_array_t</span> protocols;    <span class="comment">// åè®®åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å› ä¸ºæˆ‘ä»¬ç¼–è¯‘å¥½çš„æˆå‘˜å˜é‡å­˜å‚¨çš„ä½ç½®åœ¨ç±»çš„<code>ro</code>ä¸­ï¼Œâ¼€æ—¦ç¼–è¯‘å®Œæˆï¼Œå†…å­˜ç»“æ„å°±å®Œå…¨ç¡®å®šâ½†æ³•ä¿®æ”¹ï¼Œåªèƒ½ä¿®æ”¹ç±»çš„<code>rw</code>ä¸­çš„æ–¹æ³•æˆ–è€…å¯ä»¥é€šè¿‡å…³è”å¯¹è±¡çš„æ–¹å¼æ¥æ·»åŠ <code>å±æ€§</code>ã€‚</p>
<p>å…³è”å¯¹è±¡æ·»åŠ çš„ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li><code>objc_setAssociatedObject</code>è®¾ç½®<code>set</code>æ–¹æ³•ï¼šæ‰¾åˆ°å…³è”å¯¹è±¡çš„<strong>æ€»å“ˆå¸Œè¡¨</strong>ï¼Œç„¶åé€šè¿‡<strong>æŒ‡é’ˆåœ°å€</strong>æ‰¾åˆ°<strong>è¯¥ç±»çš„å“ˆå¸Œ</strong>è¡¨ï¼Œç„¶åé€šè¿‡keyå€¼è¿›è¡Œå­˜å‚¨</li>
<li><code>objc_getAssociatedObject</code>è®¾ç½®<code>get</code>æ–¹æ³•ï¼šå’Œsetæ–¹æ³•ä¸€æ ·æŸ¥è¯¢è¡¨ï¼Œæ‰¾åˆ°å€¼</li>
<li>åœ¨ç±»çš„<code>dealloc</code>ä¼šæ¸…é™¤å…³è”å¯¹è±¡çš„å“ˆå¸Œè¡¨</li>
</ol>
<h1 id="äº”ã€isKindOfClass-å’Œ-isMemberOfClassçš„åŒºåˆ«"><a href="#äº”ã€isKindOfClass-å’Œ-isMemberOfClassçš„åŒºåˆ«" class="headerlink" title="äº”ã€isKindOfClass å’Œ isMemberOfClassçš„åŒºåˆ«"></a>äº”ã€<code>isKindOfClass</code> å’Œ <code>isMemberOfClass</code>çš„åŒºåˆ«</h1><h2 id="ç­”ï¼š"><a href="#ç­”ï¼š" class="headerlink" title="ç­”ï¼š"></a>ç­”ï¼š</h2><p>å½“è°ƒç”¨è€…å¯¹è±¡æ˜¯<code>å®ä¾‹å¯¹è±¡</code>æ—¶ï¼šã€å¸¸ç”¨ã€‘</p>
<p><code>-isKindOfClass</code>ï¼šåˆ¤æ–­è°ƒç”¨è€…å¯¹è±¡æ˜¯å¦æ˜¯xxç±»ä»¥åŠä»–çš„å­ç±»çš„å®ä¾‹<br><code>-isMemberOfClass</code>ï¼šåˆ¤æ–­è°ƒç”¨è€…å¯¹è±¡æ˜¯å¦æ˜¯xxç±»çš„å®ä¾‹</p>
<p>å½“è°ƒç”¨è€…å¯¹è±¡æ˜¯<code>ç±»å¯¹è±¡</code>æ—¶ï¼šã€å¯å¿½ç•¥ã€‘</p>
<p><code>+isKindOfClass</code>ï¼šåˆ¤æ–­å½“å‰ç±»å¯¹è±¡çš„å…ƒç±»å¯¹è±¡åŠå…¶çˆ¶ç±»çš„å…ƒç±»å¯¹è±¡æ˜¯å¦ç­‰äºä¼ å…¥çš„å¯¹è±¡</p>
<p><code>+isMemberOfClass</code>ï¼šåˆ¤æ–­å½“å‰ç±»å¯¹è±¡çš„å…ƒç±»å¯¹è±¡æ˜¯å¦ç­‰äºä¼ å…¥çš„è¿™ä¸ªå¯¹è±¡</p>
<h2 id="åŸç†æ¢ç©¶ï¼š"><a href="#åŸç†æ¢ç©¶ï¼š" class="headerlink" title="åŸç†æ¢ç©¶ï¼š"></a>åŸç†æ¢ç©¶ï¼š</h2><p>ä¸¾ä¾‹ï¼š</p>
<p>1.æ¶ˆæ¯æ¥æ”¶è€…æ˜¯å®åŠ›å¯¹è±¡-&gt;è°ƒç”¨å¯¹è±¡æ–¹æ³•</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> re5 = [(<span class="keyword">id</span>)[<span class="built_in">NSObject</span> alloc] isKindOfClass:[<span class="built_in">NSObject</span> <span class="keyword">class</span>]];       <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">BOOL</span> re6 = [(<span class="keyword">id</span>)[<span class="built_in">NSObject</span> alloc] isMemberOfClass:[<span class="built_in">NSObject</span> <span class="keyword">class</span>]];     <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">BOOL</span> re7 = [(<span class="keyword">id</span>)[LGPerson alloc] isKindOfClass:[LGPerson <span class="keyword">class</span>]];       <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">BOOL</span> re8 = [(<span class="keyword">id</span>)[LGPerson alloc] isMemberOfClass:[LGPerson <span class="keyword">class</span>]];     <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot; re5 :%hhd\n re6 :%hhd\n re7 :%hhd\n re8 :%hhd\n&quot;</span>,re5,re6,re7,re8);</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°Logçš„æ‰“å°ç»“æœä¸º1ï¼Œ0ï¼Œ0ï¼Œ0</p>
<p>2.æ¶ˆæ¯æ¥æ”¶è€…æ˜¯ç±»å¯¹è±¡-&gt;è°ƒç”¨ç±»æ–¹æ³•</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> re1 = [(<span class="keyword">id</span>)[<span class="built_in">NSObject</span> <span class="keyword">class</span>] isKindOfClass:[<span class="built_in">NSObject</span> <span class="keyword">class</span>]];       <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">BOOL</span> re2 = [(<span class="keyword">id</span>)[<span class="built_in">NSObject</span> <span class="keyword">class</span>] isMemberOfClass:[<span class="built_in">NSObject</span> <span class="keyword">class</span>]];     <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">BOOL</span> re3 = [(<span class="keyword">id</span>)[LGPerson <span class="keyword">class</span>] isKindOfClass:[LGPerson <span class="keyword">class</span>]];       <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">BOOL</span> re4 = [(<span class="keyword">id</span>)[LGPerson <span class="keyword">class</span>] isMemberOfClass:[LGPerson <span class="keyword">class</span>]];     <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot; re1 :%hhd\n re2 :%hhd\n re3 :%hhd\n re4 :%hhd\n&quot;</span>,re1,re2,re3,re4);</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°Logçš„æ‰“å°ç»“æœä¸º1ï¼Œ1ï¼Œ1ï¼Œ1</p>
<p>å¯¹äºç¬¬1ä¸ªä¾‹å­ï¼Œå¤§å®¶éƒ½ä½¿ç”¨çš„éå¸¸ç†Ÿç»ƒï¼Œä½†æ˜¯å¯¹äºç¬¬2ä¸ªä¾‹å­çš„æ‰“å°ç»“æœå°±æœ‰äº›çº³é—·äº†ã€‚æˆ‘ä»¬å‘ç°ä¸¤ä¸ªä¾‹å­çš„ä¸»è¦åŒºåˆ«åœ¨äºæ¶ˆæ¯æ¥å—è€…æ˜¯<strong>å®ä¾‹å¯¹è±¡</strong>è¿˜æ˜¯<strong>ç±»å¯¹è±¡</strong>ã€‚</p>
<p>å…¶å®è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯æœ‰å¯¹åº”çš„ç±»æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„ï¼Œåªä¸è¿‡æˆ‘ä»¬å¹³æ—¶ä¸ä½¿ç”¨ç±»æ–¹æ³•è€Œå·²ï¼ŒæŸ¥çœ‹æºç ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***********************************************************************</span></span><br><span class="line"><span class="comment">* object_getClass.</span></span><br><span class="line"><span class="comment">* Locking: None. If you add locking, tell gdb (rdar://7516456).</span></span><br><span class="line"><span class="comment">**********************************************************************/</span></span><br><span class="line"><span class="comment">// object_getClass()æ–¹æ³•å–å¾—çš„æ˜¯å¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">// å¯¹äºå¯¹è±¡æ¥è¯´å°±æ˜¯è·å–åˆ°ä»–çš„ç±»</span></span><br><span class="line"><span class="comment">// å¯¹äºç±»å¯¹è±¡æ¥è¯´å°±æ˜¯è·å–åˆ°ä»–çš„å…ƒç±»</span></span><br><span class="line"><span class="function">Class <span class="title">object_getClass</span><span class="params">(id obj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (obj) <span class="keyword">return</span> obj-&gt;getIsa();</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> Nil;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ¤æ–­å½“å‰ç±»å¯¹è±¡çš„å…ƒç±»å¯¹è±¡æ˜¯å¦ä¸ä¼ å…¥çš„è¿™ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œæ‰€ä»¥è¿™ä¸ªclsåº”è¯¥æ˜¯å…ƒç±»å¯¹è±¡æ‰æœ‰å¯èƒ½ä¸º true</span></span><br><span class="line">+ (<span class="built_in">BOOL</span>)isMemberOfClass:(Class)cls &#123;</span><br><span class="line"><span class="keyword">return</span> object_getClass((<span class="keyword">id</span>)<span class="keyword">self</span>) == cls;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ¤æ–­å½“å‰å®ä¾‹å¯¹è±¡çš„ç±»å¯¹è±¡æ˜¯å¦ä¸ä¼ å…¥çš„å¯¹è±¡ç›¸ç­‰ï¼Œæ‰€ä»¥clsåªæœ‰å¯èƒ½æ˜¯ç±»å¯¹è±¡æ‰æœ‰å¯èƒ½ç›¸ç­‰</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isMemberOfClass:(Class)cls &#123;</span><br><span class="line"><span class="keyword">return</span> [<span class="keyword">self</span> <span class="keyword">class</span>] == cls;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾ªç¯åˆ¤æ–­å½“å‰ç±»å¯¹è±¡çš„å…ƒç±»å¯¹è±¡åŠå…¶çˆ¶ç±»çš„å…ƒç±»å¯¹è±¡æ˜¯å¦ç­‰äºä¼ å…¥çš„cls</span></span><br><span class="line">+ (<span class="built_in">BOOL</span>)isKindOfClass:(Class)cls &#123;</span><br><span class="line">  <span class="keyword">for</span> (Class tcls = object_getClass((<span class="keyword">id</span>)<span class="keyword">self</span>); tcls; tcls = tcls-&gt;superclass) &#123;</span><br><span class="line">    <span class="keyword">if</span> (tcls == cls) <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾ªç¯åˆ¤æ–­å½“å‰å®ä¾‹å¯¹è±¡çš„çˆ¶ç±»çš„ç±»å¯¹è±¡æ˜¯å¦ç­‰äºä¼ å…¥çš„å¯¹è±¡clsï¼Œä¹Ÿå°±æ˜¯åˆ¤æ–­å®ä¾‹å¯¹è±¡æ˜¯å¦æ˜¯clsåŠå…¶å­ç±»çš„ä¸€ç§</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isKindOfClass:(Class)cls &#123;</span><br><span class="line">  <span class="keyword">for</span> (Class tcls = [<span class="keyword">self</span> <span class="keyword">class</span>]; tcls; tcls = tcls-&gt;superclass) &#123;</span><br><span class="line">    <span class="keyword">if</span> (tcls == cls) <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ‰€ä»¥ï¼Œå¦‚æœæ–¹æ³•è°ƒç”¨è€…æ˜¯å®ä¾‹å¯¹è±¡ï¼Œé‚£ä¹ˆä¼ å…¥çš„å°±åº”è¯¥æ˜¯ç±»å¯¹è±¡ï¼›å¦‚æœæ–¹æ³•è°ƒç”¨è€…æ˜¯ç±»å¯¹è±¡ï¼Œé‚£ä¹ˆä¼ å…¥çš„å°±åº”è¯¥æ˜¯å…ƒç±»å¯¹è±¡ã€‚</strong></p>
<h1 id="å…­ã€-self-class-ã€-super-class-ã€-self-superclass-çš„åŒºåˆ«ä»¥åŠåŸç†åˆ†æ"><a href="#å…­ã€-self-class-ã€-super-class-ã€-self-superclass-çš„åŒºåˆ«ä»¥åŠåŸç†åˆ†æ" class="headerlink" title="å…­ã€[self class]ã€[super class]ã€[self superclass]çš„åŒºåˆ«ä»¥åŠåŸç†åˆ†æ"></a>å…­ã€[self class]ã€[super class]ã€[self superclass]çš„åŒºåˆ«ä»¥åŠåŸç†åˆ†æ</h1><h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><ul>
<li><p>class:è·å–å½“å‰æ–¹æ³•è°ƒç”¨è€…çš„ç±»</p>
</li>
<li><p>superclass:è·å–å½“å‰æ–¹æ³•è°ƒç”¨è€…çš„çˆ¶ç±»</p>
</li>
<li><p>super:æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œç»“æ„ä½“ä¸­æ¶ˆæ¯æ¥æ”¶è€…è¿˜æ˜¯å½“å‰å¯¹è±¡ï¼Œæ‰€ä»¥å°±ä¼šè®©<code>å½“å‰å¯¹è±¡</code>å»<code>è°ƒç”¨çˆ¶ç±»æ–¹æ³•</code>ï¼Œæœ¬è´¨è¿˜æ˜¯å½“å‰å¯¹è±¡åœ¨è°ƒç”¨</p>
</li>
</ul>
<h2 id="ä¾‹"><a href="#ä¾‹" class="headerlink" title="ä¾‹"></a>ä¾‹</h2><p>åˆ›å»ºä¸€ä¸ªStudentç±»ç»§æ‰¿å­Personç±»ï¼ŒæŸ¥çœ‹æ‰“å°ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;[self class] = %@&quot;</span>, [<span class="keyword">self</span> <span class="keyword">class</span>]);           <span class="comment">// [self class] = Student</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;[super class] = %@&quot;</span>, [<span class="keyword">super</span> <span class="keyword">class</span>]);			   <span class="comment">// [super class] = Student</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;[self superclass] = %@&quot;</span>, [<span class="keyword">self</span> superclass]); <span class="comment">// [self superclass] = Person</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;[super superclass] = %@&quot;</span>, [<span class="keyword">super</span> superclass]);<span class="comment">// [super superclass] = Person</span></span><br></pre></td></tr></table></figure>

<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>å…ˆä¸Šæºç çœ‹ä¸€ä¸‹ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªçš„ç†è§£</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="comment">// object_getClass()æ–¹æ³•å–å¾—çš„æ˜¯å¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡</span></span><br><span class="line"> <span class="comment">// å¯¹äºå¯¹è±¡æ¥è¯´å°±æ˜¯è·å–åˆ°ä»–çš„ç±»</span></span><br><span class="line"> <span class="comment">// å¯¹äºç±»å¯¹è±¡æ¥è¯´å°±æ˜¯è·å–åˆ°ä»–çš„å…ƒç±»</span></span><br><span class="line"> Class object_getClass(<span class="keyword">id</span> obj)</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="keyword">if</span> (obj) <span class="keyword">return</span> obj-&gt;getIsa();</span><br><span class="line">     <span class="keyword">else</span> <span class="keyword">return</span> Nil;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> + (Class)<span class="keyword">class</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> - (Class)<span class="keyword">class</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> object_getClass(<span class="keyword">self</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> + (Class)superclass &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">self</span>-&gt;superclass;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> - (Class)superclass &#123;</span><br><span class="line">   <span class="keyword">return</span> [<span class="keyword">self</span> <span class="keyword">class</span>]-&gt;superclass;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">Class class_getSuperclass(Class cls)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!cls) <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    <span class="keyword">return</span> cls-&gt;superclass;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çŸ¥é“ï¼Œè¿™é‡Œæ–¹æ³•ä¸­çš„<code>self</code>éƒ½æ˜¯æŒ‡<code>æ¶ˆæ¯çš„æ¥å—è€…</code>ï¼Œåœ¨è¿™é‡Œå°±è¡¨ç¤º<code>Student</code>ç±»ï¼Œæ ¹æ®ä»¥ä¸Šæºç ï¼Œç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªæ²¡å•¥ç–‘é—®ï¼Œéƒ½æ˜¯å¯»æ‰¾<code>Student</code>çš„<code>isa</code>å’Œçˆ¶ç±»ã€‚</p>
<p><strong>é‚£ä¹ˆ<code>super</code>è°ƒç”¨æ—¶ï¼Œæœ‰å•¥ä¸åŒï¼Œæˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“<code>super</code>çš„æœ¬è´¨</strong></p>
<p>é€šè¿‡clangç¼–è¯‘ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåº•å±‚è°ƒç”¨æ—¶<code>super</code>è°ƒç”¨çš„æ–¹æ³•ä¸æ˜¯<code>msgSend</code>,è€Œæ˜¯<code>objc_msgSendSuper(object ,superclass, @selector(class))</code>ï¼Œä¼ å…¥äº†ä¸€ä¸ª<code>super</code>çš„ç»“æ„ä½“å’Œæ–¹æ³•ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“æ¶ˆæ¯å‘é€çš„æ—¶å€™ï¼Œæ…¢é€ŸæŸ¥æ‰¾æµç¨‹æ˜¯éœ€è¦ä»è‡ªèº«é€’å½’æŸ¥æ‰¾åˆ°<code>NSObject</code>çš„ï¼Œè€Œ<code>objc_msgSendSuper</code>å°±è¡¨ç¤ºç›´æ¥ä»æ¶ˆæ¯æ¥å—è€…çš„çˆ¶ç±»å¼€å§‹é€’å½’æŸ¥æ‰¾ï¼Œè·³è¿‡äº†æœ¬èº«çš„æ–¹æ³•åˆ—è¡¨ï¼Œè¿™æ ·æŸ¥æ‰¾çš„é€Ÿåº¦å¯ä»¥æ›´å¿«ã€‚</p>
<p><code>super</code>çš„ç»“æ„ä½“å¦‚ä¸‹</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">objc_super</span> &#123;</span></span><br><span class="line">    __unsafe_unretained _Nonnull id receiver;</span><br><span class="line">    __unsafe_unretained _Nonnull Class super_class;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä¸ºæ¶ˆæ¯çš„æ¥å—è€…å’Œçˆ¶ç±»ï¼Œåœ¨è¿™é‡Œ<code>Student</code>å³ä¸ºæ¶ˆæ¯æ¥å—è€…,<code>Person</code>ä¸ºçˆ¶ç±».</p>
<p>æ‰€ä»¥è°ƒç”¨<code>[super class]</code>å’Œ<code>[super superclass]</code>æœ¬è´¨ä¸Šæ¶ˆæ¯çš„æ¥å—è€…è¿˜æ˜¯<code>self</code>ï¼Œå³<code>Student</code>ç±»ã€‚æ‰€ä»¥å°±è·Ÿç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªç»“æœæ²¡æœ‰åŒºåˆ«ã€‚</p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p><code>[self class]</code> å°±æ˜¯å‘é€æ¶ˆæ¯<code>objc_msgSend</code>ï¼Œæ¶ˆæ¯æ¥å—è€…æ˜¯ <code>self</code>,â½…æ³•ç¼–å·ï¼šclass</p>
<p><code>[super class]</code> æœ¬è´¨å°±æ˜¯<code>objc_msgSendSuper</code>, æ¶ˆæ¯çš„æ¥å—è€…è¿˜æ˜¯ <code>self</code> â½…æ³•ç¼–å·ï¼šclass(çˆ¶ç±»çš„)</p>
<p>åªæ˜¯<code>objc_msgSendSuper</code> ä¼šæ›´å¿« ç›´æ¥è·³è¿‡ <code>self</code> çš„æŸ¥æ‰¾,ä½†æ˜¯éƒ½ä¼šèµ°åˆ°<code>NSObject</code>åŸºç±»çš„å®ç°æ–¹æ³•ä¸­ï¼Œä½†æ˜¯éƒ½æ˜¯ä»¥<code>self</code>ä¸ºæ¥å—è€…</p>
<h1 id="ä¸ƒã€Runtime-æ˜¯å¦‚ä½•å®ç°-weak-çš„ï¼Œä¸ºä»€ä¹ˆå¯ä»¥â¾ƒåŠ¨ç½®-nilï¼Ÿ"><a href="#ä¸ƒã€Runtime-æ˜¯å¦‚ä½•å®ç°-weak-çš„ï¼Œä¸ºä»€ä¹ˆå¯ä»¥â¾ƒåŠ¨ç½®-nilï¼Ÿ" class="headerlink" title="ä¸ƒã€Runtime æ˜¯å¦‚ä½•å®ç° weak çš„ï¼Œä¸ºä»€ä¹ˆå¯ä»¥â¾ƒåŠ¨ç½® nilï¼Ÿ"></a>ä¸ƒã€Runtime æ˜¯å¦‚ä½•å®ç° weak çš„ï¼Œä¸ºä»€ä¹ˆå¯ä»¥â¾ƒåŠ¨ç½® nilï¼Ÿ</h1><p>ä¸»è¦æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ol>
<li>é€šè¿‡<code>SideTable</code>æ‰¾åˆ°æˆ‘ä»¬çš„<code>weak_table</code></li>
<li><code>weak_table</code> æ ¹æ®<code>referent</code> æ‰¾åˆ°æˆ–è€…åˆ›å»º <code>weak_entry_t</code></li>
<li>ç„¶å<code>append_referrer(entry, referrer)</code>å°†æ–°å¼±å¼•â½¤çš„å¯¹è±¡åŠ è¿›å»<code>entry</code></li>
<li>æœ€å<code>weak_entry_insert</code> æŠŠ<code>entry</code>åŠ â¼Šåˆ°æˆ‘ä»¬çš„<code>weak_table</code></li>
<li>åœ¨ç±»<code>dealloc</code>æ—¶ï¼Œä¼šæ ¹æ®æ’å…¥çš„æ­¥éª¤æ‰¾åˆ°å¯¹åº”çš„å¼±å¼•ç”¨ï¼Œå¹¶ç½®ä¸º<code>nil</code></li>
</ol>
<p>å…³äº<code>weak</code>çš„ç›¸å…³çŸ¥è¯†åšäº†å•ç‹¬çš„æ€»ç»“ï¼Œè¯¦æƒ…å¯ä»¥çœ‹ä¸‹æ–¹æ–‡ç« ğŸ‘‡</p>
<p><a target="_blank" rel="noopener" href="https://www.evilimo.com/2021/02/17/iOS%C2%B7%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/11-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B9%8Bweak%E5%8E%9F%E7%90%86%E6%8E%A2%E7%A9%B6/#more">11-weakåŸç†æ¢ç©¶</a></p>
<h1 id="å…«ã€Method-Swizzling-çš„å‘ä¸åº”â½¤"><a href="#å…«ã€Method-Swizzling-çš„å‘ä¸åº”â½¤" class="headerlink" title="å…«ã€Method Swizzling çš„å‘ä¸åº”â½¤"></a>å…«ã€Method Swizzling çš„å‘ä¸åº”â½¤</h1><p>è¯¦æƒ…å¯ä»¥çœ‹ä¸‹é¢çš„æ–‡ç« ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://www.evilimo.com/2021/02/18/iOS%C2%B7%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/12-Method%20Swizzling%E7%9A%84%E5%9D%91%E4%B8%8E%E5%BA%94%E7%94%A8/#more">12-Method Swizzlingçš„å‘ä¸åº”ç”¨</a></p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844904051876823047#heading-12">iOSåº•å±‚å­¦ä¹  - Runtimeä¹‹ç –å‚é¢è¯•ç­”ç–‘</a></p>
</div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/02/17/iOS%C2%B7%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/11-weak%E5%8E%9F%E7%90%86%E6%8E%A2%E7%A9%B6/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">11-weakåŸç†æ¢ç©¶</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/01/25/iOS%C2%B7%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/09-%E5%88%86%E7%B1%BB%E3%80%81%E7%B1%BB%E6%8B%93%E5%B1%95%E7%9A%84%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B/"><span class="level-item">09-åˆ†ç±»ã€ç±»æ‹“å±•çš„åŠ è½½è¿‡ç¨‹ &amp; loadã€initializeåˆ†æ</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">ç›®å½•</h3><ul class="menu-list"><li><a class="level is-mobile" href="#ä¸€ã€ä»€ä¹ˆæ˜¯-Runtime"><span class="level-left"><span class="level-item">ä¸€ã€ä»€ä¹ˆæ˜¯ Runtime</span></span></a></li><li><a class="level is-mobile" href="#äºŒã€æ–¹æ³•çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ"><span class="level-left"><span class="level-item">äºŒã€æ–¹æ³•çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ</span></span></a></li><li><a class="level is-mobile" href="#ä¸‰ã€sel-æ˜¯ä»€ä¹ˆï¼ŸIMP-æ˜¯ä»€ä¹ˆï¼Ÿä¸¤è€…ä¹‹é—´çš„å…³ç³»ï¼Ÿ"><span class="level-left"><span class="level-item">ä¸‰ã€sel æ˜¯ä»€ä¹ˆï¼ŸIMP æ˜¯ä»€ä¹ˆï¼Ÿä¸¤è€…ä¹‹é—´çš„å…³ç³»ï¼Ÿ</span></span></a></li><li><a class="level is-mobile" href="#å››ã€èƒ½å¦å‘è¿â¾æ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ æˆå‘˜å˜é‡ï¼Ÿ"><span class="level-left"><span class="level-item">å››ã€èƒ½å¦å‘è¿â¾æ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ æˆå‘˜å˜é‡ï¼Ÿ</span></span></a></li><li><a class="level is-mobile" href="#äº”ã€isKindOfClass-å’Œ-isMemberOfClassçš„åŒºåˆ«"><span class="level-left"><span class="level-item">äº”ã€isKindOfClass å’Œ isMemberOfClassçš„åŒºåˆ«</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ç­”ï¼š"><span class="level-left"><span class="level-item">ç­”ï¼š</span></span></a></li><li><a class="level is-mobile" href="#åŸç†æ¢ç©¶ï¼š"><span class="level-left"><span class="level-item">åŸç†æ¢ç©¶ï¼š</span></span></a></li></ul></li><li><a class="level is-mobile" href="#å…­ã€-self-class-ã€-super-class-ã€-self-superclass-çš„åŒºåˆ«ä»¥åŠåŸç†åˆ†æ"><span class="level-left"><span class="level-item">å…­ã€[self class]ã€[super class]ã€[self superclass]çš„åŒºåˆ«ä»¥åŠåŸç†åˆ†æ</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ç»“è®º"><span class="level-left"><span class="level-item">ç»“è®º</span></span></a></li><li><a class="level is-mobile" href="#ä¾‹"><span class="level-left"><span class="level-item">ä¾‹</span></span></a></li><li><a class="level is-mobile" href="#åŸç†"><span class="level-left"><span class="level-item">åŸç†</span></span></a></li><li><a class="level is-mobile" href="#å°ç»“"><span class="level-left"><span class="level-item">å°ç»“</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ä¸ƒã€Runtime-æ˜¯å¦‚ä½•å®ç°-weak-çš„ï¼Œä¸ºä»€ä¹ˆå¯ä»¥â¾ƒåŠ¨ç½®-nilï¼Ÿ"><span class="level-left"><span class="level-item">ä¸ƒã€Runtime æ˜¯å¦‚ä½•å®ç° weak çš„ï¼Œä¸ºä»€ä¹ˆå¯ä»¥â¾ƒåŠ¨ç½® nilï¼Ÿ</span></span></a></li><li><a class="level is-mobile" href="#å…«ã€Method-Swizzling-çš„å‘ä¸åº”â½¤"><span class="level-left"><span class="level-item">å…«ã€Method Swizzling çš„å‘ä¸åº”â½¤</span></span></a></li><li><a class="level is-mobile" href="#å‚è€ƒ"><span class="level-left"><span class="level-item">å‚è€ƒ</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://cdn.jsdelivr.net/gh/speam/blogImgs@main/imglogo.png" alt="IMO&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2021 IMO</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/speam"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script></body></html>